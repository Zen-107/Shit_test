<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gift Finder ‚Äì Homepage</title>
  <link rel="stylesheet" href="assets/css/global.css" />
  <link rel="stylesheet" href="assets/css/index.css" />
</head>

<body>
  <header class="navbar">
    <div class="container nav-content">
      <a class="logo" href="index.html">üéÅ Gift Finder</a>
      <nav class="nav-links">
        <a href="form.html">Find Gifts</a>
        <a href="blog.html">Blog</a>
        <a href="results.html">Product</a>

        <!-- ‡∏õ‡∏∏‡πà‡∏° Login (‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô) -->
        <a id="login-entry" href="login.html">Login</a>

<!----------------------------------‡∏ö‡∏±‡∏ß--------------------------------------------------------->
        <!-- ‡πÄ‡∏°‡∏ô‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß) -->
        <div class="profile-menu" id="profileMenu" style="display: none;">
          <button class="profile-toggle" id="profileToggle">
            Profile ‚ñæ
          </button>
        <div class="profile-dropdown" id="profileDropdown">
          <a href="#" id="fav-link">Favorite</a>
          <a href="#" id="friend-link">Friend</a>
          <button id="logoutBtn" type="button">Logout</button>

          <!-- Dropdown ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á (‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô) -->
          <div class="sub-dropdown" id="favDropdown" style="display: none;">
            <h4>Favorites</h4>
            <a href="#">Gift 1</a>
            <a href="#">Gift 2</a>
            <a href="#">Gift 3</a>
          </div>
          <div class="sub-dropdown" id="friendDropdown" style="display: none;">
            <h4>Friends</h4>
            <a href="#">Friend A</a>
            <a href="#">Friend B</a>
            <a href="#">Friend C</a>
          </div>
        </div>
        </div>
          
          </nav>
        </div>

<!----------------------------------‡∏ö‡∏±‡∏ß--------------------------------------------------------->

  </header>

  <main>
    <section class="slideshow">
      <div class="slides-container">
        <div class="slide active">
          <img src="https://i0.wp.com/emle.org/wp-content/uploads/revslider/blog/demo-img-2.png?ssl=1">
        </div>
        <div class="slide">
          <img src="https://i0.wp.com/emle.org/wp-content/uploads/revslider/blog/demo-img-2.png?ssl=1">
        </div>
        <div class="slide">
          <img src="https://i0.wp.com/emle.org/wp-content/uploads/revslider/blog/demo-img-2.png?ssl=1">
        </div>
      </div>
      <button class="slide-btn prev" aria-label="Previous slide">‚ùÆ</button>
      <button class="slide-btn next" aria-label="Next slide">‚ùØ</button>
      <div class="dots">
        <span class="dot active" data-index="0"></span>
        <span class="dot" data-index="1"></span>
        <span class="dot" data-index="2"></span>
      </div>
    </section>

    <section class="hero container">
      <div class="hero-text">
        <h1>Find the perfect birthday gift</h1>
        <p>Choose gifts that match budget and personality.</p>
        <a class="btn primary" href="form.html">Start Gift Finder</a>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <h2>Popular Picks</h2>
        <div id="popular" class="grid cards"></div>
      </div>
    </section>

  </main>

  <footer class="footer">
    <div class="footer-container">

      <div class="footer-columns">
        <div class="footer-col">
          <h4>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
          <a href="#">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>
          <a href="#">‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</a>
          <a href="#">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a>
          <a href="#">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</a>
        </div>

        <div class="footer-col">
          <h4>‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</h4>
          <a href="#">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</a>
          <a href="#">‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
          <a href="#">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢</a>
        </div>

        <div class="footer-col">
          <h4>‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h4>
          <a href="#">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a>
          <a href="#">‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</a>
        </div>

        <div class="footer-col">
          <h4>‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏£‡∏≤</h4>
          <div class="social-icons">
            <i>üìò</i>
            <i>üì∑</i>
            <i>‚ñ∂Ô∏è</i>
            <i>üê¶</i>
          </div>
        </div>
      </div>

      <div class="footer-copy">
        ¬© 2025 Gift Finder
      </div>

    </div>
  </footer>

  <script src="assets/js/app.js"></script>


<script>
  document.addEventListener('DOMContentLoaded', async () => {
    const container = document.getElementById('popular');

    try {
      // üåê ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ô‡∏µ‡πâ
      const response = await fetch('api/get_all_product.php');

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      const data = await response.json();

      // ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ data ‡πÄ‡∏õ‡πá‡∏ô array ‡∏à‡∏£‡∏¥‡∏á‡πÜ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ PHP ‡∏™‡πà‡∏á array ‡∏°‡∏≤‡∏ï‡∏£‡∏á‡πÜ)
      if (!Array.isArray(data)) {
        throw new Error('‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
      }

      // ‚úÖ ‡∏™‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 5 ‡∏ä‡∏¥‡πâ‡∏ô
      const shuffled = [...data].sort(() => 0.5 - Math.random());
      const items = shuffled.slice(0, 4);

      container.innerHTML = items.map(p => `
        <div class="card">
          <img src="${p.image_url || 'https://via.placeholder.com/300x160?text=No+Image'}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/300x160?text=Error'">
          <div class="card-body">
            <div class="badge">${p.categories[0] || 'Gift'}</div>
            <strong>${p.name}</strong>
            <div class="price">
              ${p.min_price !== null ?
                (p.min_price === p.max_price ?
                  `${p.min_price.toLocaleString()} ${p.currency}` :
                  `${p.min_price.toLocaleString()}‚Äì${p.max_price.toLocaleString()} ${p.currency}`
                ) :
                '‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠'}
            </div>
            <div>${p.description?.substring(0, 80) || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢'}...</div>
            <div class="stack">
              <a class="btn" href="product.php?id=${p.id}">View</a>
              ${p.external_urls && p.external_urls.length > 0
                ? `<a class="btn secondary" href="${p.external_urls[0].url}" target="_blank">Buy</a>`
                : `<a class="btn secondary" href="#" onclick="alert('Coming soon!'); return false;">Buy</a>`
              }
            </div>
          </div>
        </div>
      `).join('');

    } catch (error) {
      console.error('‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', error);

      container.innerHTML = `
        <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
          <div>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ</div>
          <div style="font-size: 0.9rem; color: #777; margin-top: 0.5rem;">
            ${error.message || '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á'}
          </div>
        </div>
      `;
    }
  });
</script>


<!-- ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏ô‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->

  <script>
    (async () => {
      const loginLink = document.getElementById("login-entry");
      const profileMenu = document.getElementById("profileMenu");
      const profileToggle = document.getElementById("profileToggle");
      const profileDropdown = document.getElementById("profileDropdown");
      const logoutBtn = document.getElementById("logoutBtn");

      if (!loginLink || !profileMenu || !profileToggle || !profileDropdown || !logoutBtn) {
        console.warn("nav profile elements not found");
        return;
      }

      // ---- ‡∏ú‡∏π‡∏Å dropdown ‡πÉ‡∏´‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏°‡∏≠ ----
      profileToggle.addEventListener("click", () => {
        profileDropdown.classList.toggle("open");
      });

      document.addEventListener("click", (e) => {
        if (!profileMenu.contains(e.target)) {
          profileDropdown.classList.remove("open");
        }
      });
//-------------------------------------
  const favLink = document.getElementById("fav-link");
  const friendLink = document.getElementById("friend-link");
  const favDropdown = document.getElementById("favDropdown");
  const friendDropdown = document.getElementById("friendDropdown");

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ã‡πà‡∏≠‡∏ô dropdown ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á
  function hideSubDropdowns() {
    favDropdown.style.display = "none";
    friendDropdown.style.display = "none";
  }

// ‡∏Ñ‡∏•‡∏¥‡∏Å Favorite ‚Üí ‡πÅ‡∏™‡∏î‡∏á favDropdown + ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API
favLink.addEventListener("click", async (e) => {
  console.log("Favorite clicked");
  e.preventDefault();
  hideSubDropdowns();

  try {
    const response = await fetch('api/get_all_bookmarks.php');
    const data = await response.json();

    if (data.success && data.folders.length > 0) {
      // ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
      const folderList = data.folders.map(folder => `
        <a href="folder.php?id=${folder.folder_id}">
          ${folder.folder_name}
        </a>
      `).join('');

      favDropdown.innerHTML = `
        <h4>Folders</h4>
        ${folderList}
      `;
    } else {
      favDropdown.innerHTML = '<h4>Folders</h4><p style="color: black;">No folders yet.</p>';
    }

    favDropdown.style.display = "block";

  } catch (err) {
    console.error("Failed to load folders:", err);
    favDropdown.innerHTML = '<h4>Folders</h4><p class="error-message">Error loading folders.</p>';
    favDropdown.style.display = "block";
  }
});

/////////////////////////////////////////////// ‡πÉ‡∏´‡πâ ‡πÇ‡∏ö‡∏Å‡∏µ‡πâ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ ///////////////////////////////
// ‡∏Ñ‡∏•‡∏¥‡∏Å Friend ‚Üí ‡πÅ‡∏™‡∏î‡∏á friendDropdown (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
friendLink.addEventListener("click", async (e) => {
  console.log("Friend clicked");
  e.preventDefault();
  hideSubDropdowns();

  try {
    // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≤‡∏Å API (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô)
    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô
    const friends = [
      { id: 1, name: "Friend A" },
      { id: 2, name: "Friend B" },
      { id: 3, name: "Friend C" }
    ];

    const friendList = friends.map(friend => `
      <a href="#" onclick="alert('Profile of ${friend.name}'); return false;">
        ${friend.name}
      </a>
    `).join('');

    friendDropdown.innerHTML = `
      <h4>Friends</h4>
      ${friendList}
    `;

    friendDropdown.style.display = "block";

  } catch (err) {
    console.error("Failed to load friends:", err);
    friendDropdown.innerHTML = '<h4>Friends</h4><p>Error loading friends.</p>';
    friendDropdown.style.display = "block";
  }
});
////////////////////////////////////////////////////////////////////////////////////////////////

  // ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏∑‡πà‡∏ô ‡∏ã‡πà‡∏≠‡∏ô dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
  document.addEventListener("click", (e) => {
    if (!profileMenu.contains(e.target)) {
      profileDropdown.classList.remove("open");
      hideSubDropdowns();
    }
  });
//------------------------------------
      logoutBtn.addEventListener("click", async () => {
        try {
          await fetch("api/logout.php", { method: "POST" });
        } catch (err) {
          console.error("logout error:", err);
        }
        localStorage.removeItem("user");
        location.reload();
      });

      // ---- ‡πÄ‡∏ä‡πá‡∏Ñ session ‡∏à‡∏≤‡∏Å PHP ----
      try {
        const res = await fetch("api/check_session.php");
        if (!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        if (data.loggedIn) {
          // ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
          loginLink.style.display = "none";
          profileMenu.style.display = "inline-block";
        } else {
          // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
          loginLink.style.display = "inline-block";
          loginLink.textContent = "Login";
          loginLink.href = "login.html";
          profileMenu.style.display = "none";
        }
      } catch (err) {
        console.error("check_session error:", err);
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå Login ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
        loginLink.style.display = "inline-block";
        loginLink.textContent = "Login";
        loginLink.href = "login.html";
        profileMenu.style.display = "none";
      }
    })();
  </script>


</body>

</html>